{"version":3,"sources":["webpack:///src/environments/environment.ts","webpack:///src/app/app.component.ts","webpack:///src/app/app.component.html","webpack:///src/app/app.module.ts","webpack:///src/app/user-video.service.ts","webpack:///src/app/socket-service.service.ts","webpack:///src/app/app-routing.module.ts","webpack:///src/app/user.service.ts","webpack:///src/main.ts","webpack:///$_lazy_route_resource lazy namespace object"],"names":["environment","production","AppComponent","socketService","userVideoService","connections","screenCapEnabled","subscribe","d","console","log","getUserCam","cam","userCam","playStream","userWindow","id","getUserScreen","screen","getVideoTracks","addEventListener","enableUserCam","elRef","stream","videoWindow","nativeElement","srcObject","muted","play","selector","templateUrl","styleUrls","read","AppModule","declarations","imports","providers","bootstrap","UserVideoService","navigator","mediaDevices","getUserMedia","video","audio","displayMediaOptions","cursor","md","getDisplayMedia","configuration","offerToReceiveAudio","offerToReceiveVideo","iceServers","urls","RTCPeerConnection","providedIn","SocketServiceService","http","connectionsSubject","asObservable","getSocket","setupListeners","socket","window","on","data","from","offer","connection","allUsers","find","u","sessionId","peerConnection","createPeerConnection","streams","getTracks","forEach","track","addTrack","onconnectionstatechange","event","onicecandidate","candidate","emit","setRemoteDescription","RTCSessionDescription","createAnswer","answer","setLocalDescription","remoteDesc","iceCandidate","addIceCandidate","filter","session","createOffer","next","idx","findIndex","splice","push","routes","AppRoutingModule","forRoot","exports","UserService","userId","userName","split","bootstrapModule","err","error","webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","module"],"mappings":"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","file":"main-es5.js","sourcesContent":["// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { Component, ViewChildren, ViewChild, ElementRef } from \"@angular/core\";\nimport { SocketServiceService, IConnection } from \"./socket-service.service\";\nimport { UserVideoService } from \"./user-video.service\";\n\n@Component({\n  selector: \"app-root\",\n  templateUrl: \"./app.component.html\",\n  styleUrls: [\"./app.component.scss\"],\n})\nexport class AppComponent {\n  public connections: IConnection[] = [];\n  public userCam: any;\n  public screenCapEnabled = false;\n\n  @ViewChild(\"userWindow\", { static: false, read: ElementRef })\n  private userWindow: ElementRef;\n\n  constructor(\n    private socketService: SocketServiceService,\n    private userVideoService: UserVideoService\n  ) {\n    this.socketService.connections.subscribe((d) => {\n      this.connections = d;\n      console.log(d);\n      console.log(\"connetions updated\");\n    });\n    this.userVideoService.getUserCam().subscribe((cam) => {\n      this.userCam = cam;\n      this.playStream(this.userWindow, cam);\n    });\n  }\n\n  getVideoWindow(id: string) {}\n\n  public enableScreenCapture() {\n    this.screenCapEnabled = true;\n    this.userVideoService.getUserScreen().subscribe((screen: any) => {\n      screen.getVideoTracks()[0].addEventListener(\"ended\", () => {\n        this.enableUserCam();\n      });\n      this.playStream(this.userWindow, screen);\n    });\n  }\n\n  public enableUserCam(): void {\n    this.screenCapEnabled = false;\n    this.playStream(this.userWindow, this.userCam);\n  }\n\n  private playStream(elRef: ElementRef, stream: any): void {\n    const videoWindow = elRef.nativeElement;\n    videoWindow.srcObject = stream;\n    videoWindow.muted = true;\n    videoWindow.play();\n    videoWindow.addEventListener(\"ended\", () => {\n      console.log(\"ended\");\n    });\n  }\n}\n","<ng-container *ngFor=\"let c of connections\">\n  <video width=\"100\" #clientFeed controls autoplay id=\"{{c.userId}}\">\n  </video>\n</ng-container>\n\n<video #userWindow style=\"border: 1px solid red;\" width=\"400\" height=\"300\">\n</video>\n<button *ngIf=\"!screenCapEnabled\" (click)=\"enableScreenCapture()\">Screen Cap</button>","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\n\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './app.component';\nimport { HttpClientModule } from '@angular/common/http';\n\nimport { SocketServiceService } from './socket-service.service';\nimport { UserVideoService } from './user-video.service';\nimport { UserService } from './user.service';\n\n@NgModule({\n  declarations: [\n    AppComponent\n  ],\n  imports: [\n    BrowserModule,\n    AppRoutingModule,\n    HttpClientModule,\n  ],\n  providers: [\n    SocketServiceService,\n    UserVideoService,\n    UserService\n  ],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n","import { Injectable } from '@angular/core';\nimport { from } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UserVideoService {\n  constructor() { }\n\n  public getUserCam() {\n    return from(navigator.mediaDevices.getUserMedia({video: true, audio: true}));\n  }\n  \n  public getUserScreen() {\n    const displayMediaOptions = {\n      video: {\n        cursor: \"always\"\n      },\n      audio: false\n    };\n\n    const md:any = navigator.mediaDevices;\n    return from(md.getDisplayMedia(displayMediaOptions));\n  }\n\n  public createPeerConnection() {\n    \n    const configuration = {\n      configuration: {\n        offerToReceiveAudio: true,\n        offerToReceiveVideo: true\n      },\n      iceServers: [{ urls: 'stun:stun.l.google.com:19302' }]\n    }\n    return new RTCPeerConnection(configuration)\n  }\n}\n","import { Injectable } from \"@angular/core\";\nimport { HttpClient } from \"@angular/common/http\";\nimport * as io from \"socket.io-client\";\nimport { Subject } from \"rxjs\";\nimport { UserVideoService } from \"./user-video.service\";\n\n@Injectable({\n  providedIn: \"root\",\n})\nexport class SocketServiceService {\n  public sessionId: string;\n  public allUsers: IConnection[];\n  public connectionsSubject = new Subject<IConnection[]>();\n  public connections = this.connectionsSubject.asObservable();\n\n  private socket: any;\n\n  constructor(\n    private http: HttpClient,\n    private userVideoService: UserVideoService\n  ) {\n    this.getSocket();\n    this.setupListeners();\n  }\n\n  getSocket() {\n    this.socket = window[\"socketIo\"]();\n    this.socket.on(\"connect\", () => {\n      console.log(\"socket connected\");\n    });\n  }\n\n  setupListeners() {\n    this.socket.on(\"sessionId\", (data) => {\n      console.log(data);\n      console.log(this.socket);\n    });\n\n    this.socket.on(\"offer\", async (from, offer) => {\n      console.log(\"offer received\");\n      console.log();\n      const connection = this.allUsers.find((u) => u.sessionId === from);\n      if (connection) {\n        connection.peerConnection =\n          this.userVideoService.createPeerConnection();\n\n        const streams = await navigator.mediaDevices.getUserMedia({\n          video: true,\n          audio: true,\n        });\n        streams.getTracks().forEach((track) => {\n          connection.peerConnection.addTrack(track, streams);\n        });\n        connection.peerConnection.onconnectionstatechange = (event) => {\n          console.log(\"peer connection event\");\n          console.log(event);\n        };\n        connection.peerConnection.onicecandidate = (event) => {\n          if (event.candidate) {\n            this.socket.emit(\n              \"iceCandidate\",\n              connection.sessionId,\n              this.socket.id,\n              event.candidate\n            );\n          }\n        };\n        connection.peerConnection.setRemoteDescription(\n          new RTCSessionDescription(offer)\n        );\n        const answer = await connection.peerConnection.createAnswer();\n        await connection.peerConnection.setLocalDescription(answer);\n        this.socket.emit(\n          \"answer\",\n          connection.sessionId,\n          this.socket.id,\n          answer\n        );\n      }\n    });\n\n    this.socket.on(\"answer\", async (from, answer) => {\n      console.log(\"answer received\");\n      const connection = this.allUsers.find((u) => u.sessionId === from);\n      const remoteDesc = new RTCSessionDescription(answer);\n      await connection.peerConnection.setRemoteDescription(remoteDesc);\n    });\n\n    this.socket.on(\"iceCandidate\", async (from, iceCandidate) => {\n      console.log(\"ice candidate received\");\n      console.log(from);\n      const connection = this.allUsers.find((u) => u.sessionId === from);\n      if (iceCandidate) {\n        console.log(iceCandidate);\n        await connection.peerConnection.addIceCandidate(iceCandidate);\n      }\n    });\n\n    this.socket.on(\"allUsers\", (data) => {\n      console.log(this.socket);\n      console.log(\"allUsers\");\n      data = data.filter((session) => session.sessionId !== this.socket.id);\n      console.log(data);\n      data.forEach(async (d) => {\n        d.peerConnection = this.userVideoService.createPeerConnection();\n        const streams = await navigator.mediaDevices.getUserMedia({\n          video: true,\n          audio: true,\n        });\n        streams.getTracks().forEach((track) => {\n          d.peerConnection.addTrack(track, streams);\n        });\n        d.peerConnection.onconnectionstatechange = (event) => {\n          console.log(\"peer connection event\");\n          console.log(event);\n        };\n        d.peerConnection.onicecandidate = (event) => {\n          console.log(\"ice candidate event\");\n          if (event.candidate) {\n            this.socket.emit(\n              \"iceCandidate\",\n              d.sessionId,\n              this.socket.id,\n              event.candidate\n            );\n          }\n        };\n        const offer = await d.peerConnection.createOffer();\n        await d.peerConnection.setLocalDescription(offer);\n        this.socket.emit(\"offer\", d.sessionId, this.socket.id, offer);\n      });\n      this.allUsers = data;\n      this.connectionsSubject.next(data);\n    });\n\n    this.socket.on(\"userDisconnected\", (sessionId) => {\n      const idx = this.allUsers.findIndex((u) => u.sessionId === sessionId);\n      if (idx > -1) {\n        this.allUsers.splice(idx, 1);\n      }\n      this.connectionsSubject.next(this.allUsers);\n    });\n\n    this.socket.on(\"newUserConnected\", (connection) => {\n      this.allUsers.push(connection);\n      this.connectionsSubject.next(this.allUsers);\n    });\n  }\n}\n\nexport interface IConnection {\n  sessionId: string;\n  name: string;\n  peerConnection: RTCPeerConnection;\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nconst routes: Routes = [];\n\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule { }\n","import { Injectable } from '@angular/core';\nimport { v4 as uuidv4 } from 'uuid';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UserService {\n  public readonly userId: string;\n  public userName: string;\n\n  constructor() {\n    this.userId = uuidv4();\n    this.userName = `Guest[${this.userId.split('-')[0]}]`\n  }\n}\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"zn8P\";"]}